{"version":3,"file":"use-course-upgrade.js","names":["_react","require","_modelStore","_reactRedux","_context","millisecondsInOneDay","useCourseUpgrade","courseId","isUpgradeEligible","useContext","CourseInfoContext","offer","accessExpiration","datesBannerInfo","useModel","verifiedMode","auditTrialLengthDays","auditTrial","useSelector","state","learningAssistant","upgradeUrl","upgradeable","auditTrialExpired","auditTrialDaysRemaining","expirationDate","auditTrialExpirationDate","Date","Math","ceil","now","isFBE","contentTypeGatingEnabled"],"sources":["../../src/hooks/use-course-upgrade.js"],"sourcesContent":["import { useContext } from 'react';\nimport { useModel } from '@src/generic/model-store'; // eslint-disable-line import/no-unresolved\nimport { useSelector } from 'react-redux';\nimport { CourseInfoContext } from '../context';\n\nconst millisecondsInOneDay = 24 * 60 * 60 * 1000; // hours*minutes*seconds*milliseconds\n\n/**\n * @typedef AuditTrial\n * @type {object}\n * @property {string} startDate Date String of when the Trial started.\n * @property {string} expirationDate Date String of when the Trial ends.\n */\n\n/**\n * @typedef CourseUpgradeInfo\n * @type {object}\n * @property {boolean} upgradeable Should this user see a trial/upgrade option?.\n * @property {number} [auditTrialLengthDays] Audit Trial full length in days.\n * @property {number} [auditTrialDaysRemaining] Remaining day for the current trial (if any).\n * @property {boolean} [auditTrialExpired] True means that the audit has been taken and expired.\n * @property {AuditTrial} [auditTrial] The Audit trial information. Undefined if there's no trial for this user.\n * @property {string} [upgradeUrl] URL to redirect the user in case there's intention to upgrade.\n */\n\n/**\n * This hook returns related data for the Course Upgrade.\n *\n * @returns {CourseUpgradeInfo}\n */\nexport default function useCourseUpgrade() {\n  const { courseId, isUpgradeEligible } = useContext(CourseInfoContext);\n  const {\n    offer,\n    accessExpiration,\n    datesBannerInfo,\n  } = useModel('coursewareMeta', courseId);\n  const { verifiedMode } = useModel('courseHomeMeta', courseId);\n  const {\n    auditTrialLengthDays,\n    auditTrial,\n  } = useSelector(state => state.learningAssistant);\n\n  const upgradeUrl = offer?.upgradeUrl || verifiedMode?.upgradeUrl;\n\n  if (!isUpgradeEligible || !upgradeUrl) { return { upgradeable: false }; }\n\n  let auditTrialExpired = false;\n  let auditTrialDaysRemaining;\n\n  if (auditTrial?.expirationDate) {\n    const auditTrialExpirationDate = new Date(auditTrial.expirationDate);\n    auditTrialDaysRemaining = Math.ceil((auditTrialExpirationDate - Date.now()) / millisecondsInOneDay);\n\n    auditTrialExpired = auditTrialDaysRemaining < 0;\n  }\n\n  const isFBE = !!accessExpiration && !!datesBannerInfo?.contentTypeGatingEnabled;\n\n  return {\n    upgradeable: true,\n    auditTrialLengthDays,\n    auditTrialDaysRemaining,\n    auditTrialExpired,\n    auditTrial,\n    upgradeUrl,\n    isFBE,\n  };\n}\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,WAAA,GAAAD,OAAA;AACA,IAAAE,WAAA,GAAAF,OAAA;AACA,IAAAG,QAAA,GAAAH,OAAA;AAFqD;;AAIrD,MAAMI,oBAAoB,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;;AAElD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACe,SAASC,gBAAgBA,CAAA,EAAG;EACzC,MAAM;IAAEC,QAAQ;IAAEC;EAAkB,CAAC,GAAG,IAAAC,iBAAU,EAACC,0BAAiB,CAAC;EACrE,MAAM;IACJC,KAAK;IACLC,gBAAgB;IAChBC;EACF,CAAC,GAAG,IAAAC,oBAAQ,EAAC,gBAAgB,EAAEP,QAAQ,CAAC;EACxC,MAAM;IAAEQ;EAAa,CAAC,GAAG,IAAAD,oBAAQ,EAAC,gBAAgB,EAAEP,QAAQ,CAAC;EAC7D,MAAM;IACJS,oBAAoB;IACpBC;EACF,CAAC,GAAG,IAAAC,uBAAW,EAACC,KAAK,IAAIA,KAAK,CAACC,iBAAiB,CAAC;EAEjD,MAAMC,UAAU,GAAG,CAAAV,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEU,UAAU,MAAIN,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEM,UAAU;EAEhE,IAAI,CAACb,iBAAiB,IAAI,CAACa,UAAU,EAAE;IAAE,OAAO;MAAEC,WAAW,EAAE;IAAM,CAAC;EAAE;EAExE,IAAIC,iBAAiB,GAAG,KAAK;EAC7B,IAAIC,uBAAuB;EAE3B,IAAIP,UAAU,aAAVA,UAAU,eAAVA,UAAU,CAAEQ,cAAc,EAAE;IAC9B,MAAMC,wBAAwB,GAAG,IAAIC,IAAI,CAACV,UAAU,CAACQ,cAAc,CAAC;IACpED,uBAAuB,GAAGI,IAAI,CAACC,IAAI,CAAC,CAACH,wBAAwB,GAAGC,IAAI,CAACG,GAAG,CAAC,CAAC,IAAIzB,oBAAoB,CAAC;IAEnGkB,iBAAiB,GAAGC,uBAAuB,GAAG,CAAC;EACjD;EAEA,MAAMO,KAAK,GAAG,CAAC,CAACnB,gBAAgB,IAAI,CAAC,EAACC,eAAe,aAAfA,eAAe,eAAfA,eAAe,CAAEmB,wBAAwB;EAE/E,OAAO;IACLV,WAAW,EAAE,IAAI;IACjBN,oBAAoB;IACpBQ,uBAAuB;IACvBD,iBAAiB;IACjBN,UAAU;IACVI,UAAU;IACVU;EACF,CAAC;AACH","ignoreList":[]}